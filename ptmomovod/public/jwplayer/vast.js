!function(){"use strict";function t(t){if(t){var e=t.match(/\b(?:[34])[0-9]{2}\b/);if(e)return parseInt(e[0],10);if(t.match(/timeout/i))return t.match(/vpaid|vast/i)?301:402;if(t.match(/found/i))return 401;if(t.match(/supported/i))return 403;if(t.match(/(?:displaying|media file)/i))return 405}return 901}function e(t){for(;t.length>0;){var e=t.pop();e.parentNode&&e.parentNode.removeChild(e)}}function i(t,e,i,n){var r=document.createElement("iframe");r.src="javascript:false",t.style(r,{border:0,width:"100%",height:"100%",position:"absolute",overflow:"hidden"}),r.scrolling="no",i.getElementsByClassName("jw-media")[0].appendChild(r);var a=r.contentWindow.document;return a.open().write("\n    <body onload=\"\n        var js = document.createElement('script');\n        js.src = '"+e+"';\n        js.addEventListener('load', function() { window.myCallback(); });\n        document.body.appendChild(js);\"\n    style=\"margin: 0\">"),r.contentWindow.myCallback=n,a.close(),r}function n(t){return{getPosition:function(){return t.getPosition()},getFile:function(){return t.getPlaylistItem().file}}}function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:900,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60900,n={};return n.message=t,n.code=e,n.adErrorCode=i,n}function a(t,e){"boolean"==typeof t.mediaFileCompliance&&(e.mediaFileCompliance=t.mediaFileCompliance,t.nonComplianceReasons&&(e.nonComplianceReasons=t.nonComplianceReasons))}function s(t){var e=[];return Rt.map(t,function(t){var i="iframe"===t.type||"html"===t.type?t.type:"static",n=void 0;t.trackers&&t.trackers.creativeView&&t.trackers.creativeView.length&&(n=t.trackers.creativeView),e.push({width:t.width,height:t.height,type:i,resource:t.source,creativeview:n,click:t.clickthrough})}),e}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=[];return Rt.map(t,function(t){t.type.indexOf("flash")<0&&e.push(t)}),e}function d(t){return"application/javascript"===t.type||"application/x-javascript"===t.type}function l(t){return d(t)?"html5":"flash"}function h(t,e){for(var i=void 0,n="flash"===e,r=0;r<t.media.length;r++){var a=t.media[r];if(n){i=a;break}if("html5"===l(a)){i=a;break}}return i}function p(t,e,i){t.tracker=new Vt(t.trackers,e,i)}function u(t,e){var i=void 0;return i="flash"===e?Rt.where(jwplayer.api.availableProviders,{name:"flash"}):Rt.filter(jwplayer.api.availableProviders,function(t){return"flash"!==t.name}),Rt.filter(t,function(t){return Rt.some(i,function(e){return e.supports(t,"ads")})})}function c(t,e,i){var n=document.createElement("param");n.setAttribute("name",e),n.setAttribute("value",i),t.appendChild(n)}function f(t,e){for(var i=0;i<t.length;i++){var n=t[i];e?n._vmap.item=i+1:n._adbreak={item:i+1,tags:n._adQueue,breakid:n._breakId}}}function m(t,e,i){var n=void 0;return Ot.foreach(t,function(t,e){(n=n||{})[t]="_adQueue"===t?e.slice():e}),n&&(n.requestTimeout=e,n.creativeTimeout=i),n}function v(t,e){return"%"===t.toString().slice(-1)?e*parseFloat(t.slice(0,-1))/100:parseFloat(t)}function y(t){return Bt.isString(t)?[t]:Bt.isArray(t)?t.slice(0):t}function g(t){if("start"===t||"0%"===t)return"pre";if("end"===t||"100%"===t)return"post";if("pre"===t||"post"===t||Bt.indexOf(t,"%")>-1)return t;var e=Nt.seconds(t);return!!Bt.isNumber(e)&&e}function A(t,e){return 0===t?1/0:t||e}function P(t,e){if(!e)return t;var i=t.indexOf("?")>=0?"&":"?",n="cust_params=",r=t.indexOf(n),a=n.length,s="",o="";if(Nt.foreach(e,function(t,e){s=""+s+o+t+"="+e,o="&"}),s=encodeURIComponent(s),r>=0){var d=t.substr(0,r+a),l=t.substr(r+a);return""+d+s+"%26"+l}return""+t+i+"cust_params="+s}function k(t,e){var i=e.schedule||e.adschedule;i&&Object.keys(i).map(function(n){var r=i[n];r.ad&&(Nt.extend(r,r.ad),delete r.ad);var a=g(r.offset),s=A(r.requestTimeout,at),o=A(r.creativeTimeout,st),d={_offSet:a,_type:r.type,_breakId:n,requestTimeout:s,creativeTimeout:o};!1===a&&Nt.log("Error: ad offset format not supported",a);var l=r.skipoffset||e.skipoffset;Bt.isUndefined(l)||(d.skipoffset=l);var h=r.adbreakid;h&&(d.adbreakid=h);var p=r.adtagid;if(p&&(d._adTagQueue=y(p)),r.tag){var u=P(r.tag,r.custParams);d._adQueue=y(u),d._waterfallIndex=0}else{if(!Bt.isString(r.vastxml))return void Nt.log("Error: no ad tag provided");d._adXML=r.vastxml}switch(a){case"pre":t.setPreRoll(d);break;case"post":t.setPostRoll(d);break;default:t.addMidRoll(d)}})}function T(t,e){qt.style(t,{opacity:e||1})}function E(t){qt.style(t,{opacity:0})}function w(){T(Wt)}function b(){T(Wt,.75)}function _(){T(Xt)}function C(){T(Xt,.5)}function I(t,e){var i=[],n=V(t,"VMAP",rt);if(!n.length)throw new Error("No VMAP tag in response");L(n[0],"version")||S(i,"VMAP Schema Error: version missing from VMAP tag",it);var r=V(t,"AdBreak",rt);if(!r.length)throw new Error("No AdBreaks in VMAP");for(var a=t.lookupNamespaceURI(rt),s=0;s<r.length;s++){var o={},d={},l=r[s],h=L(l,"timeOffset"),p=L(l,"breakId"),u=L(l,"breakType"),c=L(V(l,"AdSource",rt)[0],"id"),f=V(l,"AdTagURI",rt)[0],m=V(l,"VASTData",rt)[0]||V(l,"VASTAdData",rt)[0],v=L(f,"templateType"),y=H(f),g=R(a,l,"Tracking",rt);if(u||S(i,"VMAP Schema Error: missing breakType on AdBreak",p),m||v||S(i,"VMAP Schema Error: missing templateType on AdBreak",p),h||S(i,"VMAP Schema Error: missing timeOffset on AdBreak",p),o._type=u,o._vmap={id:c,breakid:p,timeoffset:h},m)o._adXML=V(m,"VAST")[0];else{if("vast2"!==v&&"vast3"!==v&&"vast4"!==v)continue;o._adQueue=[y],o._waterfallIndex=0}var A=[];if(g)for(var P=0;P<g.length;P++){M(d,g[P]);var k=L(g[P],"event");A.push(k)}switch((A.indexOf("breakStart")<0||A.indexOf("breakEnd")<0||A.indexOf("error")<0)&&S(i,"Tracking events are missing breakStart, breakEnd, or error for AdBreak",p),o._trackers=d,o._type=u,h){case"start":o._offSet="pre",e.setPreRoll(o);break;case"100%":case"end":o._offSet="post",e.setPostRoll(o);break;default:if(/^#/.test(h))break;/^\d\d?(?:\.\d+)?%$/.test(h)?o._offSet=h:o._offSet=Jt.seconds(h),e.addMidRoll(o)}}if(!e.preRoll&&!e.midRolls.length&&!e.postRoll)throw new Error("No AdBreaks in VMAP");return e.sort(null,!0),i}function S(t,e,i){var n=r(e,1002,11002);n.id=i,t.push(n)}function x(t){var e=V(t,"Error");Zt.map(e,function(t){var e=H(t);(new Image).src=e})}function V(t,e,i){var n=[];return t&&(n=t.getElementsByTagName(e),i&&n&&0===n.length&&(n=t.getElementsByTagName(i+":"+e))),n}function R(t,e,i,n){var r=[];return t||e?r=e.getElementsByTagNameNS?e.getElementsByTagNameNS(t,i):e.getElementsByTagName(n+":"+i):r}function L(t,e){return t?t.getAttribute(e):null}function M(t,e){var i=L(e,"event");"progress"===i&&(i=i+"_"+L(e,"offset")),D(t,i,H(e))}function H(t){if(t){var e=t.textContent||t.text;if(e)return Jt.trim(e)}return""}function D(t,e,i){t[e]||(t[e]=[]),i&&t[e].push(i)}function O(t,e,i){var n=V(t,e);Zt.map(n,function(t){D(i,e.toLowerCase(),H(t))})}function j(t){var e={};Zt.map(t.media,function(t){var i=t.type,n="application/x-mpegURL"===i||"vnd.apple.mpegURL"===i;"vpaid"===t.adType.toLowerCase()||n||(e[i]=e[i]||0,e[i]++)}),t.mediaFileCompliance=!0,Zt.map(e,function(e,i){e<3&&(t.mediaFileCompliance=!1,t.nonComplianceReasons=t.nonComplianceReasons||[],t.nonComplianceReasons.push(i+" has only "+e+" qualities"))})}function U(t){var e=V(V(t,"Creatives")[0],"Creative"),i={},n={trackers:i};n.adsystem=H(V(t,"AdSystem")[0]);var r=[],a=V(t,"Category");return Zt.map(a,function(t){r.push(H(t))}),n.categories=r,Zt.map(e,function(t){var e=V(t,"Linear")[0],r=V(t,"NonLinear")[0],a=V(V(t,"TrackingEvents")[0],"Tracking"),s=V(t,"UniversalAdId")[0],o=L(s,"idRegistry")||"unknown",d=L(s,"idValue")||"unknown";e||r?(Zt.map(a,function(t){M(i,t)}),n.universalAdIdRegistry=o,n.universalAdIdValue=d):(n.companionUniversalAdIdRegistry=o,n.companionUniversalAdIdValue=d);var l=H(V(t,"AdParameters")[0]);if(l&&(n.adParams=l),e){var h=V(e,"VideoClicks")[0],p=H(V(h,"ClickThrough")[0]),u=V(h,"ClickTracking"),c=L(e,"skipoffset"),f=H(V(e,"Duration")[0]);Zt.map(u,function(t){D(i,"click",H(t))}),f&&(n.duration=Jt.seconds(f)),p&&(n.clickthrough=p),c&&(n.skipoffset=c),N(e,n)}else if(r){var m=H(V(r,"NonLinearClickThrough")[0]);m&&(n.clickthrough=m),F(t,n)}else q(t,n)}),n}function B(t){var e=V(t,"Video")[0]||t,i=V(t,"NonLinear")[0],n={},r={trackers:n};if(e){var a=V(V(t,"TrackingEvents")[0],"Tracking");Zt.map(a,function(t){M(n,t)});var s=V(V(t,"Impression")[0],"URL");Zt.map(s,function(t){D(n,"impression",H(t))});var o=V(V(t,"Error")[0],"URL");Zt.map(o,function(t){D(n,"error",H(t))});var d=V(e,"VideoClicks")[0],l=H(V(d,"ClickThrough")[0]),h=V(V(d,"ClickTracking")[0],"URL");Zt.map(h,function(t){D(n,"click",H(t))}),l&&(r.clickthrough=l),N(e,r);var p=V(e,"AdParameters")[0];if(p){var u=L(p,"apiFramework");"vpaid"===u.toLowerCase()&&(Zt.map(r.media,function(t){t.adType=u}),r.adParams=H(p))}}if(i){var c=r.media||[],f=V(i,"URL")[0];c.push({type:L(i,"creativeType"),file:H(f),adType:L(i,"apiFramework")}),r.media=c}var m=V(t,"CompanionAds")[0];return m=V(m,"Companion"),r.companions||(r.companions=[]),Zt.map(m,function(t){r.companions.push({width:parseInt(L(t,"width"),10),height:parseInt(L(t,"height"),10),type:L(t,"resourceType"),resource:H(V(t,"URL")[0]),trackers:[],clickthrough:""})}),r}function N(t,e){var i=V(V(t,"MediaFiles")[0],"MediaFile"),n=e.media?e.media:[];Zt.map(i,function(t){var e={type:L(t,"type"),file:H(t),adType:L(t,"apiFramework")||"",width:parseInt(L(t,"width"),10)||0,height:parseInt(L(t,"height"),10)||0};e.file&&n.push(e)}),e.media=n}function F(t,e){var i=[],n=V(t,"StaticResource")[0];n&&(i.push({type:L(n,"creativeType"),file:H(n),adType:L(V(t,"NonLinear")[0],"apiFramework")||"static",minDuration:L(V(t,"NonLinear")[0],"minSuggestedDuration")||"00:00:00"}),e.media=i)}function q(t,e){var i=V(V(t,"CompanionAds")[0],"Companion"),n=e.companions?e.companions:[];Zt.map(i,function(t){var e=V(t,"StaticResource")[0],i=V(t,"IFrameResource")[0],r=V(t,"HTMLResource")[0],a={},s=void 0,o=void 0;if(e)s=L(e,"creativeType"),o=H(e);else if(i)s="iframe",o=H(i);else{if(!r)return;s="html",o=H(r)}var d=V(V(t,"TrackingEvents")[0],"Tracking");Zt.map(d,function(t){var e=L(t,"event");D(a,e,H(t))});var l=H(V(t,"CompanionClickThrough")[0]);n.push({width:parseInt(L(t,"width"),10),height:parseInt(L(t,"height"),10),type:s,source:o,trackers:a,clickthrough:l})}),e.companions=n}function Q(t,e){var i=Jt.extend({},t);return Jt.foreach(e,function(t,n){Jt.exists(i[t])?"array"===Jt.typeOf(n)?i[t]=i[t].concat(n):"object"===Jt.typeOf(n)?i[t]=Jt.extend(i[t],e[t]):i[t]=n:i[t]=n}),i}function X(t){t&&(t.onload=null,t.onreadystatechange=null,t.onerror=null,t.abort&&t.abort())}function W(t,e,i){var n=[];return i.foreach(e,function(e,r){t.companions&&(r.companions=(r.companions?r.companions:[]).concat(t.companions)),t.trackers&&(r.trackers=z(r.trackers,t.trackers,i)),t.sequence&&(r.sequence=t.sequence),n.push(r)}),n}function z(t,e,i){return t=t||{},i.foreach(e,function(e,i){t[e]?t[e]=t[e].concat(i):t[e]=i}),t}function G(t,e){return K(t)?t:e.parseXML(t)}function K(t){return"object"==typeof Node?t instanceof Node:t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName}function Y(t,e,i,n){if(!t)return t;var r=Z(e),a=r.item,s=window.location.href;t=J(t=J(t=J(t=J(t=J(t=J(t=J(t=J(t,"__random-number__",Math.random()*Math.pow(10,18)),"__timestamp__",(new Date).getTime()),"__page-url__",encodeURIComponent(s)),"__referrer__",encodeURIComponent(document.referrer)),"__player-height__",r.playerHeight),"__player-width__",r.playerWidth),"__item-duration__",r.itemDuration),"__domain__",encodeURIComponent(i));for(var o=(t=n.companion?J(t,"__companion-div__",n.companion.id):J(t,"__companion-div__","")).match(new RegExp(/__item-[a-z 0-9 A-Z]*__/g)),d=0;o&&d<o.length;d++){var l=o[d],h=l.substring(7,l.length-2);if(a.hasOwnProperty(h)&&e._.isString(a[h])){var p=a[h];p.length>1e3&&(p=p.substring(0,1e3)),t=J(t,l,encodeURIComponent(p))}else t=J(t,l,"")}return t=$(t)}function $(t){return re.test(t)||ae.test(t)?t+="&sdk3p=jwplayer":se.test(t)&&(t+=";sdk3p=jwplayer"),t}function J(t,e,i){return t.replace(e,i)}function Z(t){var e=t.getConfig();return{playerHeight:t.getHeight()||e.height||"",playerWidth:t.getWidth()||e.width||"",itemDuration:tt(t.getDuration(),3)||"",item:e.playlist[t.getPlaylistIndex()]||{}}}function tt(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i}function et(t){return t._adQueue&&t._waterfallIndex<t._adQueue.length}var it="-1",nt="time",rt="vmap",at=5e3,st=15e3,ot="buffering",dt="paused",lt="playing",ht="complete",pt="error",ut="adClick",ct="adComplete",ft="adError",mt="adImpression",vt="beforePlay",yt="adPause",gt="adSkipped",At="adStarted",Pt="none",kt="auto",Tt={QUARTILE:"quartile",REMAINING_TIME:"remainingTimeChange",SKIPPED:"skipped",STARTED:"started",STOPPED:"stopped",CLICK:"click",PLAY:"play",IMPRESSION:"impression",PAUSE:"pause",ERROR:"error",COMPLETE:"complete",CLOSE:"close",EXPANDED_CHANGE:"expandedChange"},Et=[mt,ft,"adPodError"],wt=[At,ct,mt,ut,gt,ft,"adPlay",yt,"adMeta"],bt=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},_t=function(){function t(e,i,n,r,a,s){var o=this;bt(this,t),this.player=e,this.utils=e.utils,this.environment=e.getEnvironment(),this._=e._,this.swf=i,this.adTag=r,this.adParams=a,this.vpaidControls=s,this.resumeOnAdStopped=!1,this.paused=!1,this.flashThrottled=!1,this.type="vpaid",this.blocking=null,this.vpaidState={linear:!1,expanded:!1,remainingTime:-1};var d=-1;this._.extend(this,e.Events),this.environment.Browser.chrome&&this.swf.on("throttle",function(t){clearTimeout(d),"resume"===t.state?(o.flashThrottled=!1,o.onAdPlaying(o.vpaidState),o.setPointerEventsStyle(Pt),o.callVPAID("resumeAd")):d=setTimeout(function(){o.setPointerEventsStyle(kt),o.callVPAID("pauseAd"),o.onAdPaused(o.vpaidState),o.flashThrottled=!0},250)},this),this.swf.triggerFlash("vast:loadVpaid",n,this.genCallback(this.vpaidLoadSuccess.bind(this)),this.genCallback(this.vpaidError.bind(this)))}return t.prototype.vpaidLoadSuccess=function(){this.setPointerEventsStyle(kt),this.addVPAIDListener("AdLoaded",this.onAdLoaded),this.addVPAIDListener("AdStarted",this.onAdStarted),this.addVPAIDListener("AdLinearChange",this.onLinearChange),this.addVPAIDListener("AdExpandedChange",this.onExpandedChange),this.addVPAIDListener("AdPaused",this.onAdPaused),this.addVPAIDListener("AdPlaying",this.onAdPlaying),this.addVPAIDListener("AdStopped",this.onAdStopped),this.addVPAIDListener("AdVideoComplete",this.onAdComplete),this.addVPAIDListener("AdRemainingTimeChange",this.onRemainingTimeChangeHandler),this.addVPAIDListener("AdClickThru",this.onAdClick),this.addVPAIDListener("AdSkipped",this.onAdSkipped),this.addVPAIDListener("AdError",this.vpaidError),this.addVPAIDListener("AdVideoFirstQuartile",this.onFirstQuartile),this.addVPAIDListener("AdVideoMidpoint",this.onMidpoint),this.addVPAIDListener("AdVideoThirdQuartile",this.onThirdQuartile);var t=this.player.getSafeRegion(!1);this.callVPAID("initAd",t.width,t.height+t.y,this.fullscreenMode(),0,this.adParams)},t.prototype.setPointerEventsStyle=function(t){this.environment.Browser.ie&&"PointerEvent"in window&&(this.swf.style.pointerEvents=t)},t.prototype.fullscreenMode=function(){return this.player.getFullscreen()?"fullscreen":"normal"},t.prototype.vpaidError=function(){this.sendEvent(Tt.ERROR)},t.prototype.sendEvent=function(t,e){this.flashThrottled||(e=e||{},e.linear=this.vpaidState.linear?"linear":"nonlinear",e.tag=this.adTag,this.trigger(t,e))},t.prototype.updateVpaidState=function(t){t&&(this._.isBoolean(t.linear)&&(this.vpaidState.linear=t.linear),this._.isBoolean(t.expanded)&&(this.vpaidState.expanded=t.expanded),this._.isNumber(t.remainingTime)&&(this.vpaidState.remainingTime=t.remainingTime))},t.prototype.onAdLoaded=function(t){this.onLinearChange(t),this.setVPAIDProperty("adVolume",this.player.getMute()?0:this.player.getVolume()/100),this.callVPAID("startAd")},t.prototype.onAdStarted=function(t){this.updateVpaidState(t),t.linear&&this.blocking&&!this.vpaidControls&&this.blocking.hide(),this.sendEvent(Tt.IMPRESSION),this.sendEvent(Tt.PLAY,{oldstate:ot,newstate:lt}),this.sendEvent(Tt.STARTED)},t.prototype.onAdClick=function(t){this.updateVpaidState(t),this.sendEvent(Tt.CLICK,{url:t.url,playerHandles:t.playerHandles})},t.prototype.onAdSkipped=function(t){this.updateVpaidState(t),this.sendEvent(Tt.SKIPPED)},t.prototype.onLinearChange=function(t){this.updateVpaidState(t);var e=void 0,i=void 0,n=void 0;if(t.linear){if(this.blocking)this.vpaidControls||this.blocking.hide();else{this.resumeOnAdStopped=!0,this.player.setControls(!1);var r=this.player.getState();r!==lt&&r!==ot||this.player.pause()}i=(n=this.player.getSafeRegion(!1)).height+n.y,e=n.width}else this.blocking?(this.blocking.destroy(),this.blocking=null):this.resumeOnAdStopped&&(this.player.play(),this.player.setControls(!0)),n=this.player.getSafeRegion(!0),i=n.height+n.y,e=n.width;this.callVPAID("resizeAd",e,i,this.fullscreenMode())},t.prototype.onExpandedChange=function(t){this.updateVpaidState(t),this.sendEvent(Tt.EXPANDED_CHANGE,{expanded:this.vpaidState.expanded})},t.prototype.onAdStopped=function(t){this.updateVpaidState(t),this.resumeOnAdStopped&&(this.player.play(),this.player.setControls(!0)),this.setPointerEventsStyle(Pt),this.sendEvent(Tt.STOPPED)},t.prototype.onAdComplete=function(){this.setPointerEventsStyle(Pt),this.sendEvent(Tt.COMPLETE)},t.prototype.onAdPaused=function(t){this.updateVpaidState(t),this.paused||(this.paused=!0,this.sendEvent(Tt.PAUSE,{newstate:dt,oldstate:lt}))},t.prototype.onAdPlaying=function(t){this.updateVpaidState(t),this.paused&&(this.paused=!1,this.sendEvent(Tt.PLAY,{newstate:lt,oldstate:dt}))},t.prototype.onRemainingTimeChangeHandler=function(t){this.updateVpaidState(t),this.sendEvent(Tt.REMAINING_TIME,{remainingTime:t.remainingTime})},t.prototype.onFirstQuartile=function(t){this.handleQuartile(1,t)},t.prototype.onMidpoint=function(t){this.handleQuartile(2,t)},t.prototype.onThirdQuartile=function(t){this.handleQuartile(3,t)},t.prototype.handleQuartile=function(t,e){this.updateVpaidState(e),this.sendEvent("quartile",{quartile:t,remainingTime:e.remainingTime})},t.prototype.callVPAID=function(){var t=Array.prototype.slice.call(arguments);t.unshift("vast:callVpaid"),this.swf.triggerFlash.apply(this.swf,t)},t.prototype.setVPAIDProperty=function(t,e){this.swf.triggerFlash("vast:setVpaidProperty",t,e)},t.prototype.addVPAIDListener=function(t,e){this.swf.triggerFlash("vast:addVpaidListener",t,this.genCallback(e.bind(this)))},t.prototype.genCallback=function(t){var e=t.name?t.name.replace("bound ",""):"",i=this.player.id+":vast:"+e+":"+Math.random().toString(16).substr(2);return this.swf.on(i,t,this),i},t.prototype.genEvent=function(t){var e=this;return function(i){e.on(t,i)}},t.prototype.setVolume=function(t){this.setVPAIDProperty("adVolume",t/100)},t.prototype.volume=function(){},t.prototype.mute=function(){},t.prototype.play=function(){this.callVPAID("resumeAd")},t.prototype.pause=function(){this.callVPAID("pauseAd")},t.prototype.stop=function(){this.callVPAID("stopAd")},t.prototype.resize=function(){var t=this.player.getSafeRegion(!this.vpaidState.linear);this.callVPAID("resizeAd",t.width,t.height+t.y,this.fullscreenMode())},t.prototype.removeEvents=function(){this.off()},t.prototype.destroy=function(){this.removeEvents(),this.setPointerEventsStyle(Pt),this.swf.off(null,null,this),this.blocking=null},t.prototype.getState=function(){return this.vpaidState.linear?this.paused?dt:lt:"idle"},t}(),Ct=function(){function n(t,e,r,a,s,o){var d=this;return bt(this,n),this.player=t,this._=t._,this.state=t.state,this.vpaidURL=e,this.adTag=r,this.adParams=a,this.vpaidControls=s,this.type="vpaid",this.blocking=null,this.toRemove=[],this.vpaidState={linear:!1,expanded:!1,remainingTime:-1},this.paused=!1,this._.extend(this,t.Events),this.setMuteCallback=this.setMute.bind(this),this.playerContainer=this.player.getContainer(),o?void setTimeout(function(){d.sendEvent("error",{message:"Conditional ad rejected",code:408})},0):(this.iframe=i(t.utils,this.vpaidURL,this.playerContainer,this.callback.bind(this)),void this.toRemove.push(this.iframe))}return n.prototype.sendEvent=function(t,e){(e=e||{}).tag||(e.tag=this.adTag),this.trigger(t,e)},n.prototype.sendTimeEvent=function(t,e,i){var n=e.getAdDuration(),r=e.getAdRemainingTime(),a=this._.extend({duration:n},i);this.sendEvent(t,a),r>0&&(a.position=n-r,this.trigger("time",a))},n.prototype.handleQuartile=function(t,e){this.sendTimeEvent("quartile",t,{quartile:e})},n.prototype.genEvent=function(t){var e=this;return function(i){e.on(t,i)}},n.prototype.setMute=function(){this.player.setMute(!this.vpaidAd.getAdVolume())},n.prototype.userActive=function(){var t=this.player.utils.hasClass(this.playerContainer,"jw-flag-time-slider-above");this.player.utils.style(this.iframe,{bottom:t?66:60})},n.prototype.userInactive=function(){"paused"!==this.player.getState()&&this.player.utils.style(this.iframe,{bottom:"0.5em"})},n.prototype.prepareNonlinearAd=function(){var t=!this.player.utils.hasClass(this.playerContainer,"jw-flag-user-inactive");this.player.utils.style(this.iframe,{height:150}),this.resize(null,150),this.userActive(t),this.player.on("userActive",this.userActive,this),this.player.on("userInactive",this.userInactive,this),this.blocking&&(this.blocking.applyProviderListeners(null),this.blocking.destroy(),this.blocking=null)},n.prototype.genListeners=function(i){var n=this;return{AdLoaded:function(){i.startAd()},AdStarted:function(){i.getAdLinear()?n.blocking&&!n.vpaidControls&&n.blocking.hide():n.prepareNonlinearAd(),n.sendEvent("impression",{linear:i.getAdLinear()?"linear":"nonlinear"}),n.sendEvent("play",{oldstate:ot,newstate:lt,linear:i.getAdLinear()?"linear":"nonlinear"}),i.subscribe(n.setMuteCallback,"AdVolumeChange",i)},AdVideoStart:function(){n.sendEvent("started")},AdStopped:function(){e(n.toRemove),n.player.getConfig().controls&&n.player.setControls(!0),n.sendEvent("stopped")},AdPaused:function(){n.paused||(n.paused=!0,n.sendEvent("pause",{newstate:dt,oldstate:lt}))},AdPlaying:function(){n.paused&&(n.paused=!1,n.sendEvent("play",{newstate:lt,oldstate:dt,linear:i.getAdLinear()?"linear":"nonlinear"}))},AdLinearChange:function(){if(i.getAdLinear())if(n.player.utils.style(n.iframe,{height:"100%"}),n.player.off(null,null,n),n.blocking)n.vpaidControls||n.blocking.hide();else{n.player.setControls(!1);var t=n.player.getState();t!==lt&&t!==ot||n.player.pause(!0)}else n.prepareNonlinearAd(),n.player.play(),n.player.setControls(!0)},AdDurationChange:function(){n.sendTimeEvent("remainingTimeChange",i,{isDurationChange:!0,remainingTime:i.getAdRemainingTime()})},AdRemainingTimeChange:function(){n.sendTimeEvent("remainingTimeChange",i,{remainingTime:i.getAdRemainingTime()})},AdExpandedChange:function(){n.sendEvent("expandedChange",{expanded:i.getAdExpanded()})},AdSkipped:function(){e(n.toRemove),n.player.getConfig().controls&&n.player.setControls(!0),n.sendEvent("skipped")},AdVideoFirstQuartile:function(){n.handleQuartile(i,1)},AdVideoMidpoint:function(){n.handleQuartile(i,2)},AdVideoThirdQuartile:function(){n.handleQuartile(i,3)},AdVideoComplete:function(){n.sendEvent("complete")},AdUserClose:function(){n.sendEvent("close")},AdClickThru:function(t,e,i){n.sendEvent("click",{id:e,url:t,playerHandles:i})},AdError:function(i){e(n.toRemove);var r=t(i);n.sendEvent("error",{message:i,code:r,adErrorCode:5e4+r})}}},n.prototype.callback=function(){var t=this.vpaidAd=this.iframe.contentWindow.getVPAIDAd(),e=this.player.getMute()?0:this.player.getVolume()/100,i=t.handshakeVersion("2.0");if(parseFloat(i)<1)throw new Error("Invalid vpaid version in handshake");this.listeners=this.genListeners(t),this._.each(this.listeners,t.subscribe,t);var n={AdParameters:this.adParams},r=this.playerContainer.getElementsByClassName("jw-media")[0],a=this.video=r.getElementsByTagName("video")[0],s=this.iframe.contentWindow.document.createElement("div");s.className="jw-vpaid-wrapper",s.style.height="100%",this.iframe.contentWindow.document.body.appendChild(s),a?a.removeAttribute("preload"):((a=this.video=document.createElement("video")).setAttribute("webkit-playsinline",""),a.setAttribute("playsinline",""),r.insertBefore(a,this.iframe),this.toRemove.push(a));var o={videoSlot:a,slot:s};t.initAd(r.clientWidth,r.clientHeight,"normal",1e3,n,o),t.setAdVolume(e)},n.prototype.play=function(){this.vpaidAd.resumeAd()},n.prototype.pause=function(){this.vpaidAd.pauseAd()},n.prototype.stop=function(){if(this.vpaidAd)try{this.vpaidAd.stopAd()}catch(t){console.log("Unhandled exception from VPAID2 Creative stopAd",t)}},n.prototype.setVolume=function(t){this.vpaidAd.setAdVolume(t/100)},n.prototype.resize=function(t,e){if(this.vpaidAd&&this.vpaidAd.resizeAd){var i=this.player.getFullscreen()||document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen?"fullscreen":"normal";this.vpaidAd.resizeAd(t||this.player.getWidth(),e||this.player.getHeight(),i)}},n.prototype.destroy=function(){if(e(this.toRemove),this.removeEvents(),this.vpaidAd)try{this._.each(this.listeners,this.vpaidAd.unsubscribe,this.vpaidAd),this.vpaidAd.unsubscribe(this.setMuteCallback,"AdVolumeChange")}catch(t){console.log("Unhandled exception from VPAID2 Creative",t)}this.blocking=null},n.prototype.removeEvents=function(){this.player.off(null,null,this),this.off()},n.prototype.attachMedia=function(){},n.prototype.detachMedia=function(){},n.prototype.volume=function(){},n.prototype.mute=function(){},n.prototype.getState=function(){return this.vpaidState.linear?this.paused?dt:lt:"idle"},n}(),It=jwplayer.utils,St=jwplayer._,xt=[],Vt=function(){function t(e,i,r){var a=this;bt(this,t),this.map=e,this.debugTrackFn=i,this.trackerPlayerUtils=n(r),this.lastQuartile=0,this.progressEvents=[],this.started=!1,this.firedError=!1,this.hasComp=!1,St.map(e,function(t,i){if(e.hasOwnProperty(i)&&0===i.indexOf("progress")){var n=""+i.split("_")[1],r={key:i,offset:n,tracked:!1,percentage:!1};/^\d+%$/.test(n)?(r.percentage=!0,r.offset=parseFloat(n)):r.offset=It.seconds(n),a.progressEvents.push(r)}}),this.setFactories()}return t.prototype.getUrls=function(t){return this.map.hasOwnProperty(t)?this.map[t]:[]},t.prototype.addUrl=function(t,e){this.map.hasOwnProperty(t)?this.map[t].push(e):(this.map[t]=[],this.map[t].push(e))},t.prototype.trackPings=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getUrls(t),n=[],r=[];e=this.replaceMacros(e),St.map(i,function(t){if(t){St.each(e,function(e,i){t=t.replace(i,e)});var i=new Image;i.src=t,n.push(t),r.push(i)}});for(var a=xt.length;a--&&(xt[a].width||xt[a].complete);)xt.length=a;Array.prototype.push.apply(xt,r),St.isFunction(this.debugTrackFn)&&this.debugTrackFn({type:"ping",data:{pingType:t,urls:n,images:r}})},t.prototype.replaceMacros=function(t){return t["[TIMESTAMP]"]=encodeURIComponent(this.generateTimestamp()),t["[CACHEBUSTING]"]=Math.random().toString().slice(2,10),t["[ASSETURI]"]=encodeURIComponent(this.trackerPlayerUtils.getFile()),t["[CONTENTPLAYHEAD]"]=encodeURIComponent(this.convertPlayheadOffset(this.trackerPlayerUtils.getPosition())),t},t.prototype.generateTimestamp=function(){var t=new Date,e=t.getTime(),i=t.getTimezoneOffset()/60,n=6e4*t.getTimezoneOffset();return new Date(e-n).toISOString().slice(0,-1)+(i>0?"-":"+")+("0"+i).slice(-2)},t.prototype.convertPlayheadOffset=function(t){var e=("0"+Math.floor(t/3600)).slice(-2),i=("0"+Math.floor((t-3600*e)/60)).slice(-2);return e+":"+i+":"+("0"+Math.floor(t-3600*e-60*i)).slice(-2)+"."+(t%1).toFixed(3).toString().slice(2,5)},t.prototype.start=function(){this.started=!0,this.trackPings("start")},t.prototype.breakStart=function(){this.started=!0,this.trackPings("breakStart")},t.prototype.time=function(t,e){if(!(e<=1)){for(var i=(4*t+.05)/e|0;i>this.lastQuartile&&this.lastQuartile<3;)this.lastQuartile++,1===this.lastQuartile?this.trackPings("firstQuartile"):2===this.lastQuartile?this.trackPings("midpoint"):3===this.lastQuartile&&this.trackPings("thirdQuartile");this.trackProgress(t,e)}},t.prototype.trackProgress=function(t,e){for(var i=this.progressEvents.length;i--;){var n=this.progressEvents[i];if(!n.tracked){var r=n.offset;n.percentage&&(r=e*r/100),t>=r&&(n.tracked=!0,this.trackPings(n.key))}}},t.prototype.error=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:900;this.firedError=!0;var e={};e["[ERRORCODE]"]=t,this.trackPings("error",e)},t.prototype.factory=function(t){var e=this;return function(){e.trackPings(t)}},t.prototype.setFactories=function(){this.creativeView=this.factory("creativeView"),this.click=this.factory("click"),this.skip=this.factory("skip"),this.complete=this.factory("complete"),this.pause=this.factory("pause"),this.resume=this.factory("resume"),this.mute=this.factory("mute"),this.unmute=this.factory("unmute"),this.fullscreen=this.factory("fullscreen"),this.expand=this.factory("expand"),this.collapse=this.factory("collapse"),this.acceptInvitation=this.factory("acceptInvitation"),this.close=this.factory("close"),this.rewind=this.factory("rewind"),this.impression=this.factory("impression"),this.breakEnd=this.factory("breakEnd")},t}(),Rt=jwplayer._,Lt=function(){function t(e,i,n,r,a,s){bt(this,t),this.player=i,this.utils=i.utils,this._=i._,this.staticPlayer=n,this.companion=r,this.optionalParams=a,this.debugTrackFn=s,this.scheduledAd=e.scheduledAd(),this.vastBuffet=e.adBuffet(),this.vastAdPod=e.adPod(),this.vastAd=this.vastBuffet.length?this.vastBuffet[0]:null,this.adType=null,this.vpaidPlayer=null,this.instreamPlayer=null,this.blockingInstreamPlayer=null,this.mediaType=null,this.adPodItems=null,this.creativeTimeout=null,this.vastOptions=null,this.duration=0,this.adPodIndex=0,this.initialIndex=0,this.utils.extend(this,i.Events)}return t.prototype.init=function(t){return this.init=function(){throw new Error("Adplayer can only be initialized once")},this.blockingInstreamPlayer=t,!!this.prepareAdPod()&&(this.playAd(),this.player.on("fullscreen",this.playerFullscreenHandler,this),this.player.on("volume",this.playerVolumeHandler,this),this.player.on("mute",this.muteHandler,this),this.player.on("resize",this.playerResizeHandler,this),!0)},t.prototype.getProviderType=function(){var t=this.player.getProvider();return 0===t.name.indexOf("flash")?"flash":t.name},t.prototype.flashSwf=function(){return this.player.getContainer().querySelector("object")},t.prototype.prepareAdPod=function(){var t=this,e=null,i=0,n=[],r=this.getProviderType();if(this.vastAd&&(p(this.vastAd,this.debugTrackFn,this.player),(e=this.prepareAdPodItem(this.vastAd))&&"vpaid"===e.adType&&!h(this.vastAd,r)&&(e=null)),this.vastAdPod)for(var a=null,s=0;s<this.vastAdPod.length;s++){var o=this.vastAdPod[s];p(o,this.debugTrackFn,this.player);var d=this.prepareAdPodItem(o);if(d){if(a!==d.adType&&"instream"===a)break;if(a=d.adType,"vpaid"!==d.adType||h(o,r)){var l=n.length+i===s;d&&l&&n.push(d)}else i++}else i++}if(!n.length&&!e)return this.adError("No Compatible Creatives",403),!1;var u=void 0;return n.length?(u=n,this.vastOptions=[],this._.map(u,function(e){t.vastOptions.push(t.getInstreamOptions(e.vastAd))})):(u=e,this.vastOptions=this.getInstreamOptions(this.vastAd)),this.adPodItems=u,this.adPodIndex=0,!0},t.prototype.prepareAdPodItem=function(t){t.tracker.linear="linear";var e=this.getProviderType(),i=(""+t.media[0].adType).toLowerCase()||"instream";"vpaid"!==i||h(t,e)||(i="instream");var n={vastAd:t,sources:[],adType:i};this.scheduledAd.skipoffset&&(n.skipoffset=this.scheduledAd.skipoffset);var r=t.media,a={};if(this._.map(r,function(t){n.sources.push({file:t.file,mimeType:t.type,type:(""+t.type).replace(/^(?:video|audio)\/(?:x-)?/,"")}),a[t.file]={width:t.width||0,height:t.height||0}}),"instream"===i&&(n.sources=u(n.sources,e)),0===n.sources.length)return null;this.mediaType=(""+n.sources[0].mimeType).toLowerCase(),n.vastAd.selectedMedia=n.sources[0];var s=this.player.getSafeRegion(!0),o=null,d=null;return this._.map(n.sources,function(t){var e=a[t.file];e.width<=s.width&&(!o||e.width>a[o.file].width)&&(o=t),e.width>=s.width&&(!d||e.width<a[d.file].width)&&(d=t)}),o?(n.vastAd.selectedMedia=o,o.default=!0):d&&(n.vastAd.selectedMedia=d,d.default=!0),n},t.prototype.getInstreamOptions=function(t){var e=this.optionalParams.skipoffset>=0?this.optionalParams.skipoffset:null;return{skipoffset:t.skipoffset||this.scheduledAd.skipoffset||e,skipMessage:this.optionalParams.skipMessage,skipText:this.optionalParams.skipText}},t.prototype.getVastAd=function(t){if(this.adPodItems){var e=void 0;if((e=this.adPodItems.length?this.adPodItems[t]:this.adPodItems).vastAd)return e.vastAd}else if(this.vastAdPod&&this.vastAdPod.length)return this.vastAdPod[t];return this.vastAd},t.prototype.adError=function(t,e,i){clearTimeout(this.creativeTimeout);var n=this.getVastAd(this.adPodIndex),s=r(t,e,i=i||(e?1e4+e:null));a(n,s),this.vastAdPod&&this.adPodIndex<this.vastAdPod.length-1?this.triggerEvent("adPodError",s):(n.tracker.error(s.code),n.wrappedTags&&(s.wrappedTags=n.wrappedTags),this.addConditionalAdData(s),this.triggerEvent(ft,s))},t.prototype.playAd=function(){var t=this.adPodItems[this.adPodIndex]||this.adPodItems;if(this.adType=t.adType,"vpaid"===this.adType)this.playVpaid(t.vastAd);else if("static"===this.adType)this.playStatic(),this.clearBlocking();else{var e=this._.isArray(this.adPodItems)?this.adPodItems.slice(this.adPodIndex):this.adPodItems,i=this._.isArray(this.vastOptions)?this.vastOptions.slice(this.adPodIndex):this.vastOptions;this.initialIndex=this.adPodIndex,this.playInstream(e,i),this.clearBlocking()}},t.prototype.clearVpaidBlocking=function(){if(this.vpaidPlayer.blocking){var t=this.vpaidPlayer.blocking;this.vpaidPlayer.blocking=null,this.clearBlocking(t)}},t.prototype.clearBlocking=function(t){(t=t||this.blockingInstreamPlayer)&&t!==this.instreamPlayer&&t.destroy()},t.prototype.getState=function(){return this.instreamPlayer?this.instreamPlayer.getState():this.vpaidPlayer?this.vpaidPlayer.getState():""},t.prototype.clearNonlinear=function(){this.staticPlayer.stop(),this.vpaidPlayer&&(this.clearVpaidBlocking(),this.vpaidPlayer&&(this.vpaidPlayer.stop(),this.vpaidPlayer.destroy(),this.vpaidPlayer=null))},t.prototype.destroy=function(){this.off(),this.removePlayerListeners(),this.instreamPlayer&&this.instreamPlayer.destroy(),this.vpaidPlayer&&(this.clearVpaidBlocking(),this.vpaidPlayer&&this.vpaidPlayer.destroy()),this.clearNonlinear(),this.vastLoader=null,this.player=null,this.vpaidPlayer=null,this.instreamPlayer=null,this.scheduledAd=null,this.vastBuffet=null,this.vastAd=null,this.vastAdPod=null},t.prototype.pause=function(){this.instreamPlayer?this.instreamPlayer.pause():this.vpaidPlayer&&this.vpaidPlayer.pause()},t.prototype.play=function(){this.instreamPlayer?this.instreamPlayer.play():this.vpaidPlayer&&this.vpaidPlayer.play()},t.prototype.removePlayerListeners=function(){this.player&&(this.player.off("fullscreen",this.playerFullscreenHandler,this),this.player.off("volume",this.playerVolumeHandler,this),this.player.off("mute",this.muteHandler,this)),this.instreamPlayer&&this.instreamPlayer.off(),this.vpaidPlayer&&(this.vpaidPlayer.removeEvents(),this.clearVpaidBlocking(),this.vpaidPlayer&&this.vpaidPlayer.destroy()),this.staticPlayer.stop(),this.staticPlayer.removeEvents()},t.prototype.adEventObject=function(t){var e=this.scheduledAd._adQueue||{},i={id:this.scheduledAd._id,tag:this.scheduledAd._currentTag,client:"vast",witem:this.scheduledAd._waterfallIndex||1,wcount:e.length||1,viewable:this.player.getViewable()};if(this.scheduledAd._adbreak&&(i.adschedule=this.scheduledAd._adbreak,i.adschedule.offset=this.scheduledAd._offSet),this.adPodItems&&this.adPodItems.length&&(i.sequence=this.adPodIndex+1,i.podcount=this.adPodItems.length),this.mediaType&&(i.creativetype=this.mediaType),this.scheduledAd._vmap&&(i.vmap=this.scheduledAd._vmap),-1!==wt.indexOf(t)){var n=this.getVastAd(this.adPodIndex);i.universalAdIdRegistry=n.universalAdIdRegistry,i.universalAdIdValue=n.universalAdIdValue,i.categories=n.categories}return i},t.prototype.playStatic=function(){this.vastAd.tracker.linear="nonlinear";var t=this.vastAd.media[0];this.vastAd.selectedMedia=t;var e=this.vastAd.clickthrough||"",i=this.staticPlayer;i.removeEvents(),i.on("play",this.impressionHandler,this),i.on("play",this.playHandler,this),i.on("complete",this.combinedCompleteHandler,this),i.on("click",this.clickStaticHandler,this),i.on("error",this.staticErrorHandler,this),i.playAd(t.file,e,t.minDuration,this.scheduledAd._currentTag,this.scheduledAd.requestTimeout)},t.prototype.creativeAdError=function(t,e,i){this.adError(t,e,i),this.adPodItems&&this.adPodItems.length-1>this.adPodIndex&&(this.vpaidPlayer&&this._.isFunction(this.vpaidPlayer.destroy)&&this.vpaidPlayer.destroy(),this.adPodIndex++,this.playAd())},t.prototype.playVpaid=function(t){var e=this;clearTimeout(this.creativeTimeout),this.creativeTimeout=setTimeout(function(){e.creativeAdError("VPAID tag communication timeout",900,50004)},this.scheduledAd.creativeTimeout),this.vastAd=t;var i=h(t,this.getProviderType()),n=this.optionalParams.conditionaladoptout&&t.conditionalAd;if(this.vastAd.selectedMedia=i,this.mediaType=i.type,"flash"===l(i)){var r=this.flashSwf();this.vpaidPlayer=new _t(this.player,r,i.file,this.scheduledAd._currentTag,this.vastAd.adParams,this.optionalParams.vpaidcontrols)}else this.vpaidPlayer=new Ct(this.player,i.file,this.scheduledAd._currentTag,this.vastAd.adParams,this.optionalParams.vpaidcontrols,n);this.blockingInstreamPlayer&&this.blockingInstreamPlayer.applyProviderListeners(this.vpaidPlayer),this.vpaidPlayer.blocking=this.blockingInstreamPlayer,this.vpaidPlayer.on("play",this.playHandler,this),this.vpaidPlayer.on("pause",this.pauseHandler,this),this.vpaidPlayer.on("quartile",this.quartileHandler,this),this.vpaidPlayer.on("remainingTimeChange",this.remainingTimeHandler,this),this.vpaidPlayer.on("click",this.clickVpaidHandler,this),this.vpaidPlayer.on("error",this.playbackErrorHandler,this),this.vpaidPlayer.on("impression",this.impressionHandler,this),this.vpaidPlayer.on("expandedChange",this.vpaidExpandedHandler,this),this.vpaidPlayer.on("close",this.adCloseHandler,this),this.vpaidPlayer.on("skipped",this.vpaidAdSkipped,this),this.vpaidPlayer.on("stopped",this.endOfVpaidAdHandler,this),this.vpaidPlayer.on("complete",this.adCompleteHandler,this),this.vpaidPlayer.on("started",this.adStartedHandler,this),this.setupSkipButton()},t.prototype.setupSkipButton=function(){var t=this.optionalParams.skipoffset;t&&this.blockingInstreamPlayer&&(this.blockingInstreamPlayer.off(gt,this.skipVpaidAd,this),this.blockingInstreamPlayer.setupSkipButton(t,this.optionalParams,this.utils.noop),this.blockingInstreamPlayer.on(gt,this.skipVpaidAd,this))},t.prototype.playInstream=function(t,e){var i=this;clearTimeout(this.creativeTimeout),this.creativeTimeout=setTimeout(function(){i.creativeAdError("VAST tag communication timeout",900,60004)},this.scheduledAd.creativeTimeout),this.blockingInstreamPlayer?this.instreamPlayer=this.blockingInstreamPlayer:this.instreamPlayer=this.player.createInstream().init(),this.instreamPlayer.on("play",this.playHandler,this),this.instreamPlayer.on("pause",this.pauseHandler,this),this.instreamPlayer.on("time",this.timeHandler,this),this.instreamPlayer.on("playlistItem",this.playlistItemHandler,this),this.instreamPlayer.on("complete",this.adCompleteHandler,this),this.instreamPlayer.on("playlistComplete",this.endOfAdBreakHandler,this),this.instreamPlayer.on("mute",this.muteHandler,this),this.instreamPlayer.on("instreamClick",this.clickInstreamHandler,this),this.instreamPlayer.on("adSkipped",this.adSkipped,this),this.instreamPlayer.on("error",this.playbackErrorHandler,this),this.instreamPlayer.on("mediaError",this.playbackErrorHandler,this),this.instreamPlayer.loadItem(t,e)},t.prototype.playerFullscreenHandler=function(t){var e=this.getVastAd(this.adPodIndex).tracker;t.fullscreen&&e.started&&e.fullscreen()},t.prototype.playerResizeHandler=function(t){this.vpaidPlayer&&this.vpaidPlayer.resize(t.width,t.height)},t.prototype.playerVolumeHandler=function(t){this.vpaidPlayer&&this.vpaidPlayer.setVolume(t.volume)},t.prototype.playlistItemHandler=function(t){this.instreamPlayer&&(this.adPodIndex=t.index+this.initialIndex)},t.prototype.impressionHandler=function(t){var e=this.getVastAd(this.adPodIndex),i=e.tracker;i.impression();var n={};n.adposition=this.scheduledAd._position||"",n.adtitle=e.adTitle||"",n.adsystem=e.adsystem||"",n.wrapper=e.wrapper||"",n.vastversion=e.vastversion,n.clickThroughUrl=e.clickthrough,n.duration=e.duration||0,n.mediafile={file:e.selectedMedia.file},n.linear=t.linear||i.linear,this.addConditionalAdData(n),a(e,n),this.triggerEvent(mt,n)},t.prototype.playHandler=function(t){clearTimeout(this.creativeTimeout);var e=this.getVastAd(this.adPodIndex),i=e.tracker,n=void 0;if(i.started)t.oldstate===dt&&(i.resume(),this.dispatchPlay(t));else{this.vpaidPlayer&&(i.linear=t.linear),this.instreamPlayer&&this.impressionHandler({linear:i.linear});var r=this.utils.extend({linear:i.linear},this.getInstreamOptions(e));r.message=this.optionalParams.dynamicMessage||"",r.clickthrough=e.clickthrough,r.sequence&&(r.podMessage=this.optionalParams.podMessage||""),e.adTitle&&(r.title=e.adTitle),e.companions&&(r.companions=e.companions),this.triggerEvent("adMeta",r),e.companions&&(n={},n.companions=s(e.companions),n.universalAdIdRegistry=e.companionUniversalAdIdRegistry,n.universalAdIdValue=e.companionUniversalAdIdValue,this.triggerEvent("adCompanions",n));var a=this.companion,d=void 0;d=this.utils.flashVersion()>9?e.companions:o(e.companions),this.optionalParams.companion&&d&&d.length&&(i.hasComp=a.addCompanion(this.optionalParams.companion,d)),i.start(),i.creativeView(),this.dispatchPlay(t)}},t.prototype.dispatchPlay=function(t){if("static"!==this.adType&&("vpaid"!==this.adType||"linear"===t.linear)){var e=t.oldstate,i=t.newstate,n={};n.oldstate=e,n.newstate=i,this.triggerEvent("adPlay",n),this.vpaidPlayer&&this.vpaidPlayer.trigger("state",n)}},t.prototype.pauseHandler=function(t){this.getVastAd(this.adPodIndex).tracker.pause();var e=t.oldstate,i=t.newstate,n={};n.oldstate=e,n.newstate=i,this.triggerEvent(yt,n),this.vpaidPlayer&&this.vpaidPlayer.trigger("state",{newstate:i,oldstate:e})},t.prototype.remainingTimeHandler=function(t){t.duration?this.duration=t.duration:this.duration=Math.max(1,this.duration,t.remainingTime);var e=t.remainingTime>=0?this.duration-t.remainingTime:0;this.timeHandler({position:e,duration:this.duration,isDurationChange:t.isDurationChange})},t.prototype.quartileHandler=function(t){if(t.duration)this.duration=t.duration;else{var e=4*t.remainingTime/(4-t.quartile);this.duration=Math.max(this.duration,1,e)}this.timeHandler({position:this.duration*t.quartile*.25,duration:this.duration})},t.prototype.timeHandler=function(t){var e=this.getVastAd(this.adPodIndex),i=t.position,n=t.duration,r=n-i,a=e.tracker,s=this.optionalParams.dynamicMessage||"",o=this.optionalParams.podMessage||"";if(s&&r>0){if(s=s.replace(/xx/gi,""+Math.ceil(r)),this.adPodItems&&this.adPodItems.length>1){var d=this.adPodIndex+1;s=(o=(o=o.replace(/__AD_POD_CURRENT__/g,""+d)).replace(/__AD_POD_LENGTH__/g,""+this.adPodItems.length))+s}this.instreamPlayer?this.instreamPlayer.setText(s):this.vpaidPlayer&&this.vpaidPlayer.blocking&&this.vpaidPlayer.blocking.setText(s)}if(!t.isDurationChange){a&&a.time(i,n);var l={};l.position=i,l.duration=n,this.triggerEvent("adTime",l)}},t.prototype.combinedCompleteHandler=function(){this.adCompleteHandler(),this.endOfAdBreakHandler()},t.prototype.adCompleteHandler=function(){var t=this.getVastAd(this.adPodIndex).tracker;t.firedError||(t.complete(),this.triggerEvent(ct))},t.prototype.adCloseHandler=function(){var t=this.getVastAd(this.adPodIndex).tracker;t.firedError||t.close()},t.prototype.adStartedHandler=function(){this.triggerEvent(At)},t.prototype.endOfVpaidAdHandler=function(){return this.adPodItems&&this.adPodItems.length-1>this.adPodIndex?(this.vpaidPlayer&&this._.isFunction(this.vpaidPlayer.destroy)&&this.vpaidPlayer.destroy(),this.vpaidPlayer=null,this.adPodIndex++,void this.playAd()):void this.endOfAdBreakHandler()},t.prototype.endOfAdBreakHandler=function(){this.removePlayerListeners(),this.trigger(ct)},t.prototype.muteHandler=function(t){var e=this.getVastAd(this.adPodIndex).tracker;e&&(t.mute?(e.mute(),this.vpaidPlayer&&this.vpaidPlayer.setVolume(0)):(e.unmute(),this.vpaidPlayer&&this.vpaidPlayer.setVolume(this.player.getVolume()/100)))},t.prototype.clickStaticHandler=function(){var t=this.getVastAd(this.adPodIndex);this.player.pause(!0),this.clickThrough(t)},t.prototype.clickVpaidHandler=function(t){var e=this.getVastAd(this.adPodIndex),i=!0;t&&t.url&&(!1===t.playerHandles&&(i=!1),e.clickthrough=t.url),this.clickThrough(e,i)},t.prototype.clickInstreamHandler=function(){this.instreamPlayer.getState()!==dt&&this.clickThrough(this.getVastAd(this.adPodIndex))},t.prototype.clickThrough=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.tracker.click(),this.triggerEvent(ut),window.jwcast&&window.jwcast.player.id||t.clickthrough&&e&&window.open(t.clickthrough)},t.prototype.skipVpaidAd=function(){this.endOfVpaidAdHandler(),this.vpaidAdSkipped()},t.prototype.vpaidAdSkipped=function(){this.adSkipped(),this.endOfVpaidAdHandler()},t.prototype.adSkipped=function(){this.getVastAd(this.adPodIndex).tracker.skip(),this.triggerEvent(gt)},t.prototype.playbackErrorHandler=function(t){var e=t.message||"Error Playing Ad Tag",i=t.code;(!i||i<=4)&&(i=400),this.vpaidPlayer&&this._.isFunction(this.vpaidPlayer.off)?(this.vpaidPlayer.off(),this.creativeAdError(e,i,t.adErrorCode)):this.adError(e,i,t.adErrorCode)},t.prototype.staticErrorHandler=function(){this.adError("Unable to fetch NonLinear resource",502)},t.prototype.vpaidExpandedHandler=function(t){var e=this.getVastAd(this.adPodIndex).tracker;t.expanded?e.expand():e.collapse()},t.prototype.triggerEvent=function(t,e){var i=this.adEventObject(t);e&&this.utils.extend(i,e),-1!==Et.indexOf(t)?this.trigger(t,i):this.player.trigger(t,i)},t.prototype.addConditionalAdData=function(t){this.vastAd&&(t.conditionalAd=this.vastAd.conditionalAd),this.vastAdPod&&this.vastAdPod.length&&(t.conditionalAd=this.vastAdPod[this.adPodIndex].conditionalAd),t.conditionalAdOptOut=this.optionalParams.conditionaladoptout},t}(),Mt=jwplayer.utils,Ht=jwplayer._,Dt=function(){function t(e,i){bt(this,t),this.debugTrackFn=e,this.div=null,this.elem=null,this.environment=i}return t.prototype.addCompanion=function(t,e){if(this.div=t,this.elem=document.getElementById(this.div.id),!this.elem)return!1;for(var i=0;i<e.length;i++)if(this.fitsDiv(e[i]))return this.placeCompanion(e[i]),!0;return!1},t.prototype.removeCompanion=function(){this.elem.innerHTML=""},t.prototype.sendPings=function(t){(t=t.creativeView)&&(Ht.map(t,function(t){(new Image).src=t}),Ht.isFunction(this.debugTrackFn)&&this.debugTrackFn({type:"companion",data:{trackers:t}}))},t.prototype.placeCompanion=function(t){if(this.removeCompanion(),"html"===t.type){var e=document.createElement("div");e.innerHTML=t.source;var i=e.getElementsByTagName("script");return i.length&&Ht.map(i,function(t){new Mt.scriptloader(t.src).load(),t.parentElement.removeChild(t)}),this.elem.appendChild(e),void this.sendPings(t.trackers)}if("iframe"===t.type){var n=document.createElement("iframe");return n.height=this.div.height,n.width=this.div.width,n.src=t.source,n.scrolling="no",n.style.border="none",n.marginWidth=0,n.marginHeight=0,this.sendPings(t.trackers),this.elem.innerHTML="",void this.elem.appendChild(n)}if("application/x-shockwave-flash"!==t.type){var r=new Image;r.src=t.source,Mt.exists(t.clickthrough)&&(r.onclick=function(){window.open(t.clickthrough,"_blank").focus()}),this.elem.innerHTML="",this.elem.appendChild(r),this.sendPings(t.trackers)}else{if(this.environment.Browser.msie)this.elem.innerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"\n                    width="100%" height="100%"\n                    id="'+this.elem.id+'" name="'+this.elem.id+'"\n                    tabindex=0">\n                    <param name="movie" value="'+t.source+'">\n                    <param name="allowfullscreen" value="true">\n                    <param name="allowscriptaccess" value="always">\n                    <param name="scale" value="exactfit">\n                    <param name="seamlesstabbing" value="true">\n                    <param name="wmode" value= "opaque">\n                </object>';else{var a=document.createElement("object");a.setAttribute("type","application/x-shockwave-flash"),a.setAttribute("data",t.source),a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.setAttribute("tabindex",0),c(a,"allowfullscreen","true"),c(a,"allowscriptaccess","always"),c(a,"seamlesstabbing","true"),c(a,"wmode","opaque"),this.elem.appendChild(a)}this.sendPings(t.trackers)}},t.prototype.fitsDiv=function(t){return t.width===this.div.width&&t.height===this.div.height},t}(),Ot=jwplayer.utils,jt=jwplayer._,Ut=function(){function t(){bt(this,t),this.preRoll=null,this.vmap=null,this.postRoll=null,this.midRolls=[],this.playedMidRolls=[]}return t.prototype.setPreRoll=function(t){this.preRoll=t},t.prototype.getPreRoll=function(){return m(this.preRoll,this.requestTimeout,this.creativeTimeout)},t.prototype.getPostRoll=function(){return m(this.postRoll,this.requestTimeout,this.creativeTimeout)},t.prototype.getNextMidRoll=function(t,e){if(this.sort(e),this.midRolls.length>this.playedMidRolls.length){var i=this.getClosestIndex(t,e);if(i>=0&&this.playedMidRolls.indexOf(i)<0){var n=this.midRolls[i];return this.playedMidRolls.push(i),m(n,this.requestTimeout,this.creativeTimeout)}}return null},t.prototype.getMidRolls=function(){var t=[];return Ot.foreach(this.midRolls,function(e,i){t.push(m(i))}),t},t.prototype.reset=function(){this.playedMidRolls=[]},t.prototype.addMidRoll=function(t){this.midRolls.push(t)},t.prototype.setPostRoll=function(t){this.postRoll=t},t.prototype.sort=function(t,e){(!t||t<1)&&(t=1),this.midRolls.sort(function(e,i){return v(e._offSet,t)-v(i._offSet,t)}),f(this.getAllAds(),e)},t.prototype.getAllAds=function(){var t=this.preRoll?[this.preRoll]:[],e=this.postRoll?[this.postRoll]:[];return t.concat(this.midRolls,e)},t.prototype.getAdScheduleEventObject=function(){var t=this.getAllAds(),e=[],i={tag:this.getVMAP(),client:"vast",adbreaks:[]};return jt.map(t,function(t){var i={type:t._type,offset:t._offSet};t._vmap?i.vmap=t._vmap:i.adbreak=t._adbreak,e.push(i)}),i.adbreaks=e,i},t.prototype.setVMAP=function(t){this.vmap=t},t.prototype.isVMAP=function(){return!!this.vmap},t.prototype.getVMAP=function(){return this.vmap},t.prototype.getClosestIndex=function(t,e){for(var i=this.midRolls.length;i--;)if(t>=v(this.midRolls[i]._offSet,e))return i;return-1},t}(),Bt=jwplayer._,Nt=jwplayer.utils,Ft=function(){function t(){bt(this,t)}return t.prototype.getSchedule=function(t){var e=new Ut;if(e.requestTimeout=A(t.requestTimeout,at),e.creativeTimeout=A(t.creativeTimeout,st),t.tag)e.setPreRoll({_offSet:"pre",_adQueue:y(t.tag),_waterfallIndex:0});else if(Bt.isString(t.vastxml))e.setPreRoll({_offSet:"pre",_adXML:t.vastxml});else{if(Bt.isString(t.schedule))return e.setVMAP(t.schedule),e;if(Bt.isString(t.adschedule))return e.setVMAP(t.adschedule),e;k(e,t)}return e.sort(),e},t.prototype.getOptParams=function(t){var e={cuetext:t.cuetext||"Advertisement",dynamicMessage:t.admessage||"This ad will end in xx",podMessage:t.podmessage||"Ad __AD_POD_CURRENT__ of __AD_POD_LENGTH__. ",skipoffset:t.skipoffset||-1,skipMessage:t.skipmessage||"Skip ad in xx",skipText:t.skiptext||"Skip",vpaidcontrols:t.vpaidcontrols||!1,conditionaladoptout:t.conditionaladoptout||!1},i=t.companiondiv;return i&&(e.companion={id:i.id,height:i.height,width:i.width}),e},t}(),qt=jwplayer.utils,Qt=qt.UI,Xt=document.createElement("img"),Wt=document.createElement("img");Xt.src=Wt.src='data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><circle cx="32" cy="32" r="32" fill="#191919"/><line stroke="#CCC" stroke-width="6" x1="32" y1="20" x2="32" y2="44"/><line stroke="#CCC" stroke-width="6" x1="20" y1="32" x2="44" y2="32"/></svg>',Xt.className="jw-vast-nonlinear-open-button",Wt.className="jw-vast-nonlinear-close-button";var zt={cursor:"pointer",position:"absolute",margin:"auto",left:0,right:0,bottom:0,display:"block"},Gt="opacity 0.2s",Kt={"-webkit-transition":Gt,transition:Gt},Yt=function(){function t(e,i,n,r,a){bt(this,t),this.player=e,this.environment=e.getEnvironment(),this.div=r,this.staticURL=i,this.clickURL=n,this.loadTimer=-1,this.animationTimer=-1,this.banner=null,qt.extend(this,e.Events),this.banner=document.createElement("img"),this.banner.className="jw-banner",this.banner.id=this.player.id+"_vast_static",E([Wt,Xt]),this.remove(Xt),this.div.appendChild(this.banner),this.div.appendChild(Wt),this.loadTimer=setTimeout(this.imageLoadError.bind(this),a),this.banner.onerror=this.imageLoadError.bind(this),this.banner.onload=this.onLoaded.bind(this),this.banner.src=this.staticURL}return t.prototype.onLoaded=function(){return clearTimeout(this.loadTimer),0===this.banner.naturalWidth?void this.imageLoadError():(this.removeBannerEventListeners(),qt.style(Wt,{top:-this.banner.height-8,bottom:this.banner.height-8,left:this.banner.width},!0),qt.style(Xt,{top:-16},!0),T([this.div,this.banner]),T(Wt,.75),new Qt(this.banner).on("click tap",this.sendClick.bind(this)),this.environment.OS.mobile&&(this.div.onmouseover=w,this.div.onmouseout=b),Wt.onclick=Wt.ontouchstart=this.collapse.bind(this),Xt.onclick=Xt.ontouchstart=this.expand.bind(this),void this.trigger(Tt.PLAY))},t.prototype.imageLoadError=function(){clearTimeout(this.loadTimer),this.trigger(Tt.ERROR),this.removeBanner()},t.prototype.sendClick=function(){this.trigger(Tt.CLICK)},t.prototype.collapse=function(t){var e=this;-1===this.animationTimer&&(t.preventDefault(),this.div.onmouseover=this.div.onmouseout=null,E([this.banner,Wt,Xt]),this.div.appendChild(Xt),this.animationTimer=setTimeout(function(){e.remove(e.banner),e.remove(Wt),T(Xt,.5),e.div.onmouseover=_,e.div.onmouseout=C,e.animationTimer=-1},250))},t.prototype.expand=function(t){var e=this;-1===this.animationTimer&&(t.preventDefault(),this.div.onmouseover=this.div.onmouseout=null,this.div.appendChild(this.banner),this.div.appendChild(Wt),this.animationTimer=setTimeout(function(){T([e.banner,Wt]),e.div.onmouseover=w,e.div.onmouseout=b,e.animationTimer=-1},50),E(Xt))},t.prototype.remove=function(t){this.div.contains(t)&&this.div.removeChild(t)},t.prototype.removeBannerEventListeners=function(){this.banner.onload=this.banner.onerror=null},t.prototype.removeBanner=function(){this.removeBannerEventListeners(),this.remove(this.banner)},t.prototype.removeListeners=function(){clearTimeout(this.loadTimer),clearTimeout(this.animationTimer),this.div.onmouseover=this.div.onmouseout=Wt.onclick=Xt.onclick=null,this.off(),this.removeBannerEventListeners()},t.prototype.stop=function(){E([this.div,this.banner,Wt,Xt]),setTimeout(this.removeBanner.bind(this),400),this.remove(Wt),this.remove(Xt)},t}(),$t=function(){function t(e,i){bt(this,t),this.player=e,this.div=i,this.startTime=0,this.minDur=0,this.environment=e.getEnvironment(),qt.extend(this,e.Events),this.type="static",e.on("time",this.dispatchTime,this)}return t.prototype.playAd=function(t,e,i,n,r){this.minDur=qt.seconds(i),this.adTag=n,this.static&&(this.static.removeListeners(),this.static.stop()),this.div.style.opacity=0,this.div.style.visibility="visible";var a=this.environment.Browser.firefox?{}:Kt;qt.style(this.div,qt.extend({top:"",position:"absolute",width:"100%"},a)),qt.style([Wt,Xt],qt.extend({width:"18px",height:"18px",opacity:.75},zt,a)),qt.style(Wt,{transform:"rotate(45deg)"}),this.static=new Yt(this.player,t,e,this.div,r),this.static.on(Tt.PLAY,this.startAd,this),this.static.on(Tt.CLICK,this.clickHandler,this),this.static.on(Tt.ERROR,this.errorHandler,this)},t.prototype.dispatchTime=function(t){this.trigger(nt,t)},t.prototype.startAd=function(){this.startTime=this.player.getPosition(),this.minDur>0&&(0===this.startTime?this.on(nt,this.startTimingAd,this):this.on(nt,this.timeAd,this)),this.sendEvent(Tt.PLAY)},t.prototype.startTimingAd=function(t){this.startTime=t.position,this.off(nt,this.startTimingAd,this),this.on(nt,this.timeAd,this)},t.prototype.timeAd=function(t){t.position-this.startTime>this.minDur&&(this.off(nt,this.timeAd,this),this.stop())},t.prototype.clickHandler=function(){this.sendEvent(Tt.CLICK)},t.prototype.errorHandler=function(){this.sendEvent(Tt.ERROR)},t.prototype.sendEvent=function(t,e){(e=e||{}).tag=e.tag||this.adTag,this.trigger(t,e)},t.prototype.removeEvents=function(){this.off()},t.prototype.getState=function(){return lt},t.prototype.stop=function(){this.startTime&&this.static&&(this.startTime=0,this.minDur=0,this.off(nt,this.startTimingAd,this),this.off(nt,this.timeAd,this),this.static.removeListeners(),this.static.stop(),this.sendEvent(Tt.COMPLETE))},t.prototype.pause=function(){},t}(),Jt=jwplayer.utils,Zt=jwplayer._,te=function(){function t(e){bt(this,t),this._parsedAds=[],this._error=null,this._version=null,e&&this.parse(e)}return t.prototype.parsedAds=function(){return this._parsedAds},t.prototype.error=function(){return this._error},t.prototype.version=function(){return this._version},t.prototype.parse=function(t){var e=this,i=void 0,n=void 0,r=[];"VAST"===t.nodeName?i=t:(i=V(t,"VAST")[0])||(i=V(t,"VideoAdServingTemplate")[0]),i||this.throwError(101,"Invalid VAST response"),n="VideoAdServingTemplate"===i.tagName?1:parseFloat(L(i,"version")||0),this._version=n;var a=V(i,"Ad");Zt.map(a,function(t){var i=e.parseAd(n,t);i.vastversion=n,r.push(i)}),this._parsedAds=r,this._parsedAds.length||x(i)},t.prototype.parseAd=function(t,e,i){i=i||{};var n=V(e,"InLine")[0],r=V(e,"Wrapper")[0],a=n||r,s=a?H(V(a,"AdTitle")[0]):"",o=void 0;return i.sequence=L(e,"sequence"),i.adTitle=s,(!t||t>4||t<2)&&this.throwError(102,"Vast version not supported"),4===t&&(i.conditionalAd=!!L(e,"conditionalAd")),a?(t>=2?(o=U(a),O(a,"Impression",o.trackers),O(a,"Error",o.trackers)):o=B(a),j(o),r&&(o.wrappedURI=H(V(r,"VASTAdTagURI")[0])||H(V(r,"VASTAdTagURL")[0])),o=Q(i,o)):2===t?this.throwError(900,"Invalid VAST response",60001):this.throwError(101,"Invalid VAST response",10101),o},t.prototype.throwError=function(t,e,i){var n=this,a=r(e,t,i=i||1e4+t);throw a.toString=function(){return n.code+" "+n.message},this._error=a,this._error},t}(),ee=function(){function t(e,i,n){bt(this,t),this._scheduledAd=e,this.player=i,this.utils=i.utils,this._=i._,this.options=n||{},this.utils.extend(this,i.Events),this._history=[],this.loadedAds=[],this.parser=null,this.xmlhttp=null,this.errorSent=!1}return t.prototype.flashSwf=function(){return this.player.getContainer().querySelector("object")},t.prototype.genCallback=function(t,e){var i=this.player.id+":vast:"+e.name+":"+Math.random().toString(16).substr(2);return t.on(i,e,this),i},t.prototype.load=function(t){this._history.push(t),this.errorSent=!1,this.xmlhttp=this.getXhrRequest(t)},t.prototype.getXhrRequest=function(t){var e=this,i=function(i){e.parseXmlString(i,t)},n=function(i){e.utils.log(i),e.ajaxError(i,t)};return this.utils.ajax(t,function(i){e.ajaxComplete(i,t)},function(r,a){if(e.player){var s=e.flashSwf();return s&&"Invalid XML"!==r&&"Timeout"!==r&&e.utils.crossdomain(a)?void s.triggerFlash("loadXml",a,e.genCallback(s,i),e.genCallback(s,n)):void e.ajaxError(r,t)}},{withCredentials:!0,retryWithoutCredentials:!0,requireValidXML:!0,timeout:this._scheduledAd.requestTimeout})},t.prototype.destroy=function(){X(this.xmlhttp),this.player=null},t.prototype.scheduledAd=function(){return this._scheduledAd},t.prototype.allAds=function(){return this.loadedAds},t.prototype.adPod=function(){var t=[];return this.utils.foreach(this.loadedAds,function(e,i){i.sequence&&t.push(i)}),t.sort(function(t,e){return t.sequence-e.sequence}),t},t.prototype.adBuffet=function(){var t=[];return this.utils.foreach(this.loadedAds,function(e,i){i.sequence||t.push(i)}),t},t.prototype.history=function(){return this._history},t.prototype.parseXmlString=function(t,e){this.ajaxComplete({responseXML:G(t,this.utils)},e)},t.prototype.ajaxComplete=function(e,i){var n=this;this.parser=this.parser||new te;try{this.parser.parse(e.responseXML)}catch(t){var r=t.code||900,a=t.adErrorCode||1e4+r;return void this.sendErrorEvent(t.message,r,a,i)}var s=this.parser.parsedAds();if(s&&s.length)this.loadedAds=s,this.options.wrapper=this.options.wrapper||[],this.options.wrapper.push(this.loadedAds[0].adsystem),this.utils.foreach(this.loadedAds,function(e,i){if(i.wrappedURI){n.options.wrappedTags=n.options.wrappedTags||[],n.options.wrappedTags.push(i.wrappedURI);var r=new t(n._scheduledAd,n.player,n.options);r.on(ht,function(){n.replaceWrappedAd(i,r.allAds())}),r.on(pt,function(t){n.sendAdpodErrorEvent(t.message,t.code,t.adErrorCode,t.url),n.destroyWrappedAd(i,r)}),r.load(i.wrappedURI)}else n.options.wrapper.length>1&&(i.wrapper=n.options.wrapper.slice(0,-1),i.wrappedTags=n.options.wrappedTags)}),this.checkComplete();else{var o=2===this.parser.version(),d=o?900:101,l=o?60001:10101;this.sendErrorEvent("Ad Tag Empty",d,l,i)}},t.prototype.destroyWrappedAd=function(t,e){var i=this._.indexOf(this.loadedAds,t);this.loadedAds.splice(i,1),e.destroy(),this.checkComplete()},t.prototype.replaceWrappedAd=function(t,e){var i=W(t,e,this.utils),n=this._.indexOf(this.loadedAds,t);Array.prototype.splice.apply(this.loadedAds,[n,1].concat(i)),this.checkComplete()},t.prototype.checkComplete=function(){var t=!1;this.utils.foreach(this.loadedAds,function(e,i){i.wrappedURI&&(t=!0)}),t||this.validateVast()},t.prototype.validateVast=function(){var t=this.loadedAds.slice(0),e=t.length;this._.map(t,function(e){e.media&&e.media.length||t.length--});var i=0===e,n=t.length!==e;return i||n?void this.sendErrorEvent("Ad Tag Empty",101,10101,this._history[this._history.length-1]):void this.trigger(ht,{vloader:this})},t.prototype.ajaxError=function(t,e){if(this.player.getAdBlock())this.sendErrorEvent("Ad playback blocked by an ad blocker",900,60003,e);else if("Invalid XML"===t)this.sendErrorEvent(t,100,10100,e);else if("Error loading file"===t){var i=this.options.wrappedTags&&this.options.wrappedTags.length,n=i?303:900,r=i?10303:60006;this.sendErrorEvent(t,n,r,e)}else this.sendErrorEvent("VAST could not be loaded",301,10301,e)},t.prototype.firstUrl=function(){return this._history&&this._history.length?this._history[0]:""},t.prototype.sendAdpodErrorEvent=function(t,e,i,n){if(1!==this.loadedAds.length){var a=r(t,e,i);a.vloader=this,a.url=this.firstUrl()||n,this.wrappedUrl=n,this.trigger("adPodError",a)}else this.sendErrorEvent(t,e,i,n)},t.prototype.sendErrorEvent=function(t,e,i,n){if(!this.errorSent){this.errorSent=!0;var a=r(t,e,i);a.vloader=this,a.url=this.firstUrl()||n,a.wrappedUrl=n,this.trigger(pt,a)}},t}(),ie={},ne=function(t,e){var i=this,n=ie[e];return n||(function(t,e){t.jwplayerEntitlements=e()}(this,function(){return function(t,e,i){var n={canPlayAds:!0};new t.key(e);return i(n)}}),ie[e]=new Promise(function(n,r){i.jwplayerEntitlements(t,e,function(t){return t.canPlayAds?void n():void r({message:"Ad Limit Reached"})})}))},re=/^((https?:)?\/\/)?(secure)?pubads\.g\.doubleclick\.net\/gampad\/ads\?[\S]*$/,ae=/^((https?:)?\/\/)?bid\.g\.doubleclick\.net\/dbm\/vast\?[\S]*$/,se=/^((https?:)?\/\/)?ad\.doubleclick\.net(\/ddm)?\/pfadx\/[\S]*$/;(window.jwplayerPluginJsonp||window.jwplayer().registerPlugin)("vast","8.0",function(t,e,i){function n(e){if(e){kt&&(k(kt),kt=null);kt=U.ajax(e,function(i){kt=null;try{for(var n=I(i.responseXML,Tt),a=0;a<n.length;a++){var o=n[a];o.vmap=e,t.trigger(ft,o)}t.trigger("adSchedule",Tt.getAdScheduleEventObject())}catch(t){var d=r("VMAP Schema Error: "+t.message,1002,11002);return d.id=it,d.vmap=e,void H(d)}z&&(O(Tt),Pt)&&s({type:vt})&&R()},function(t){kt=null,U.log(t),Pt&&R();var i={Timeout:1007,"Invalid XML":1e3,default:1008},n=i[t]||i.default,a=r("Error Loading VMAP Schedule",n,1e4+n);a.id=it,a.vmap=e,H(a)},{withCredentials:!0,retryWithoutCredentials:!0,requireValidXML:!0,timeout:Tt.requestTimeout})}}function a(){var e=t.getConfig().mediaElement,i="pre"===G||t.isBeforePlay()||0===t.getPosition(),n=B.Browser.safari&&B.Browser.version.major>=11||B.OS.mobile&&!q&&!!e.src;i&&n&&e.load(),u()}function s(t){if(nt)return!1;var e=Tt.getPreRoll();return kt?(a(t),!1):!(!K&&e&&(yt=o(e),d(e,t),1))}function o(e){return e._trackers?new Vt(e._trackers,Q,t):null}function d(t,e){t._position="pre",K=!0,t._id=v(12),p(t,e)}function l(t,e){t._position="mid",t._id=v(12),p(t,e)}function h(e,i){e._position="post",$=!0,t.detachMedia(),e._id=v(12),p(e,i)}function p(t,e){G=t._position,clearTimeout(dt),dt=-1,"nonlinear"!==t._type&&(Pt||a(e)),t._adXML?(t._currentTag=t._currentTag||"clientloadedtag_"+J++,m(t)):t._adQueue?f(t):(U.log("scheduled ad has no url or xml",t),R())}function u(){X.off(lt,u),Pt=t.createInstream().init(),X.trigger("blockingStarted")}function c(e){var i=t.getPlaylistItem(e.index);Tt=F.isObject(i)&&i.adschedule?Et.getSchedule(i):wt,b(),_(),V(),$=!1,K=!1,O(Tt),Tt.reset()}function f(e){rt=e;var i=e._waterfallIndex||0,n=e._adQueue[i],r=Y(n,t,D(),W);e._waterfallIndex=i+1,e._currentTag=r,F.isFunction(Q)&&Q({type:"tagReplacement",data:{actualTag:r,originalTag:n}}),y(e,r),A(e).load(r)}function m(t){t._currentTag=t._currentTag||t._adXML.toString(),y(t,t._currentTag),A(t).parseXmlString(t._adXML)}function v(t){return new Array(t+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,t)}function y(e,i){t.trigger("adRequest",g(e,i)),X._qoe.tick("adLoading"+e._id)}function g(t,e){var i=t._adQueue||{},n={},r=t.adbreakid,a=t._adTagQueue,s=t.skipoffset;if(r&&(n.adbreakid=r),a){var o=t._waterfallIndex-1;o=o<0?0:o,n.adtagid=a[o]}return F.isUndefined(s)||(n.skipoffset=s),F.extend(n,{id:t._id,tag:e||t._currentTag,client:"vast",adposition:t._position,offset:t._offSet,witem:t._waterfallIndex||1,wcount:i.length||1})}function A(e){var i=new ee(e,t);return i.on(ht,E),i.on(pt,M),i.on("adPodError",L),Z.push(i),yt&&!yt.started&&yt.breakStart(),i}function P(t){for(var e=Z.length;e--;)Z[e]===t&&(Z.splice(e,1),t.destroy())}function k(t){t.onload=null,t.onreadystatechange=null,t.onerror=null,"abort"in t&&t.abort()}function T(){kt&&(k(kt),kt=null),b(),_(),V(),t.setCues([])}function E(t){var e=t.vloader.scheduledAd();Pt||"nonlinear"===e._type?w(t):(X.off("blockingStarted"),X.once("blockingStarted",function(){w(t)}))}function w(e){var i=e.vloader;clearTimeout(dt),dt=-1,rt.isWaterfalling||V(),P(i);var n=new Lt(i,t,gt,At,W,Q);return n.on(ft,C),n.on(mt,S),n.on("adPodError",H),n.init(Pt)?(ut=Pt,Pt=null,X.off("blockingStarted"),X.off(lt,u),ut&&ut.on("adBreakEnd",function(){yt&&yt.breakEnd()}),n.on(ct,x),void tt.push(n)):void n.destroy()}function b(){for(var t=Z.length;t--;){var e=Z[t];Z.length--,e.destroy()}}function _(){X.off(lt,u);for(var t=tt.length;t--;){var e=tt[t];tt.length--,e.destroy()}}function C(e){if(ot=!1,H(e),!ot&&et(rt)){Pt=Pt||ut;var i=F.extend({},rt);return i._offset=0,i.isWaterfalling=!0,void p(i)}_(),ot=!1,dt=setTimeout(function(){dt=-1,0===Z.length&&("post"===G&&t.attachMedia(),R())},0)}function S(e){if(rt={},"pre"===e.adposition&&(void 0===e.podcount||1===e.sequence)){X._qoe.tick("adImpression"+e.id);var i=X._qoe.between("adLoading"+e.id,"adImpression"+e.id);e.timeLoading=i}t.trigger(mt,e)}function x(){0===Z.length&&"post"===G&&t.attachMedia()}function V(){tt.length&&tt[tt.length-1].clearNonlinear()}function R(){if(Pt){var t=Pt;Pt=null,t.destroy(),X.off("blockingStarted"),X.off(lt,u)}ut=null}function L(t){var e=g(t.vloader.scheduledAd(),t.url),i=r(t.message,t.code,t.adErrorCode);U.extend(e,i),t.wrappedUrl!==t.url&&(e.wrappedTag=t.wrappedUrl),ot=!1,H(e)}function M(e){var i=e.vloader,n=i.allAds();if(P(i),n&&n.length){var r=n[0];if(r){var a=r.trackers;a&&a.error&&new Vt(a,Q,t).error(e.code)}}if(L(e),!ot&&et(rt)){var s=F.extend({},rt);return s._offset=0,s.isWaterfalling=!0,void p(s)}_(),ot=!1,-1===dt&&(dt=setTimeout(function(){dt=-1,0===Z.length&&R()},0))}function H(e){U.extend(e,{client:"vast"}),yt&&yt.error(e.code),t.trigger(ft,e)}function D(){var t=window.location.href;return t=t.match(new RegExp(/^[^\/]*:\/\/\/?([^\/]*)/)),t&&t.length>1?t[1]:""}function O(e){var i=e.getMidRolls(),n=[];i.length&&U.foreach(i,function(t,e){"nonlinear"!==e._type&&n.push({begin:e._offSet,text:W.cuetext})}),t.setCues(n)}var j=this,U=t.utils,B=t.getEnvironment(),N=t.getConfig().key,F=t._,q=!!t.getConfig().sdkplatform,Q=e.debug&&e.trackFn?e.trackFn:null,X=this,W={},z=!1,G="",K=!1,$=!1,J=0,Z=[],tt=[],nt=!1,rt={},ot=!1,dt=-1,ut=void 0,yt=void 0,gt=void 0,At=void 0,Pt=void 0,kt=void 0,Tt=void 0,Et=new Ft;this.version="8.0.3",X._qoe=new jwplayer.utils.Timer;var wt=Tt=Et.getSchedule(e);Tt.isVMAP()&&n(Y(Tt.getVMAP(),t,D(),W)),U.extend(this,t.Events),U.addClass(i,"jw-plugin-vast"),t.on("destroyPlugin",function(){T()}),t.on({ready:function(){z=!0,gt=new $t(t,i),At=new Dt(Q,B),W=Et.getOptParams(e)},beforePlay:s,cast:function(t){nt=!!t.active},play:function(t){X.trigger(lt,t)},time:function(t){if(!nt&&0!==t.duration){var e=Tt.getNextMidRoll(t.position,t.duration);e&&(yt=o(e),l(e,t))}},beforeComplete:function(t){if(!nt){var e=Tt.getPostRoll();!$&&e&&(yt=o(e),h(e,t))}},playlistItem:function(e){var i=Tt;c(e),Tt.isVMAP()?i!==Tt&&n(Y(Tt.getVMAP(),t,D(),W)):t.trigger("adSchedule",Tt.getAdScheduleEventObject())},playlistComplete:c,complete:function(){V(),$=!1,K=!1}},this),t.pauseAd=function(t){if(t=!F.isBoolean(t)||t,tt.length){var e=tt[tt.length-1];t?e.pause():e.play()}},t.playAd=function(t){ot=!0,V();var e=void 0,i=0===W.requestTimeout?1/0:W.requestTimeout,n=0===W.creativeTimeout?1/0:W.creativeTimeout;e=F.isArray(t)?t.slice(0):[t],p({_id:v(12),_adQueue:e,_waterfallIndex:0,_offset:0,_position:"api",requestTimeout:i||at,creativeTimeout:n||st})},ne.call(this,U,N).catch(function(e){T(),t.off(null,null,j),t.playAd=U.noop;var i=r("Ad Error: "+e.message,null,60002);i.code=void 0,i.id=it,i.client="vast",i.tag="",t.trigger(ft,i)}),this.destroy=T})}();